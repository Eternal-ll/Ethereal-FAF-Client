<ui:UiWindow
    x:Class="FAF.UI.EtherealClient.Views.Windows.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:Ethereal.FAF.UI.Client.ViewModels"
    xmlns:v="clr-namespace:Ethereal.FAF.UI.Client.Views"
    Title="Ethereal FAF Client" WindowStyle="None"
    ExtendsContentIntoTitleBar="True"
    WindowBackdropType="Mica"
    WindowCornerPreference="Round"
    WindowStartupLocation="CenterScreen"
    d:DataContext="{d:DesignInstance {x:Type vm:ContainerViewModel}}"
    mc:Ignorable="d"
    MaxHeight="{Binding Source={x:Static SystemParameters.MaximizedPrimaryScreenHeight}}">
    <!--Background="#ff202020"-->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Canvas Grid.RowSpan="2" Opacity="{Binding BackgroundViewModel.ImageOpacity}">
            <Canvas.Style>
                <Style TargetType="Canvas">
                    <Setter Property="Effect">
                        <Setter.Value>
                            <BlurEffect Radius="{Binding BackgroundViewModel.ImageBlur}"
                                        KernelType="{Binding BackgroundViewModel.ImageKernelType}"
                                        RenderingBias="{Binding BackgroundViewModel.ImageRenderingBias}"/>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Background">
                        <Setter.Value>
                            <ImageBrush ImageSource="{Binding BackgroundViewModel.ImageUrl}"
                                        Stretch="{Binding BackgroundViewModel.ImageStretch}"/>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding BackgroundViewModel.ImageUrl}" Value="{x:Null}">
                            <Setter Property="Effect" Value="{x:Null}"/>
                            <Setter Property="Background" Value="{x:Null}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding BackgroundViewModel.ImageUrl}" Value="">
                            <Setter Property="Effect" Value="{x:Null}"/>
                            <Setter Property="Background" Value="{x:Null}"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Canvas.Style>
        </Canvas>
        <Grid Grid.Row="1" Margin="0" Visibility="{Binding MainVisibility}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <!--  This is the main navigation of the application.  -->
            <ui:NavigationStore
                x:Name="RootNavigation"
                Grid.Column="0"
                Margin="6,0,6,0"
                Frame="{Binding ElementName=RootFrame}"
                Navigated="RootNavigation_OnNavigated"
                Precache="False"
                SelectedPageIndex="-1"
                TransitionDuration="200"
                TransitionType="FadeInWithSlide">
                <ui:NavigationStore.Items>
                    <ui:NavigationItem
                        Cache="False"
                        Content="Play"
                        PageType="{x:Type v:GamesView}"
                        Icon="XboxController24"
                        ToolTip="Search lobbies to play"/>
                    <ui:NavigationItem
                        Content="Chat"
                        Icon="Chat24"
                        ToolTip="IRC chat"/>
                    <ui:NavigationItem
                        Content="Players"
                        PageType="{x:Type v:PlayersView}"
                        Icon="PeopleList24"
                        ToolTip="IRC chat"/>
                    <ui:NavigationItem
                        Content="Links"
                        Cache="False"
                        PageType="{x:Type v:LinksView}"
                        Icon="Link24"
                        ToolTip="Useful links"/>
                    <ui:NavigationItem
                        Content="Maps"
                        Icon="Map24"
                        ToolTip="Maps vault"/>
                    <ui:NavigationItem
                        Content="Mods"
                        Icon="Vault24"
                        ToolTip="Mods vault"/>
                    <ui:NavigationItem
                        Content="Replays"
                        Icon="Video24"
                        ToolTip="Replays"/>
                </ui:NavigationStore.Items>
                <ui:NavigationStore.Footer>
                    <!--  A navigation element that does not point to the page can be used as a button.  -->
                    <!--<ui:NavigationItem Click="NavigationButtonTheme_OnClick" Content="Theme" Icon="DarkTheme24" />-->
                    <ui:NavigationItem
                        Content="Settings"
                        Icon="Settings24"
                        PageType="{x:Type v:SettingsView}"
                        Cache="False"/>
                </ui:NavigationStore.Footer>
            </ui:NavigationStore>

            <!--  We display our pages inside this element.  -->
            <Border Grid.Column="1" CornerRadius="8 0 0 0">
                <Frame x:Name="RootFrame" Grid.Row="1" >
                    <Frame.Style>
                        <Style TargetType="Frame">
                            <Style.Triggers>
                                <Trigger Property="Visibility" Value="Collapsed">
                                    <Setter Property="IsEnabled" Value="False"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Frame.Style>
                </Frame>
            </Border>
        </Grid>
        <ContentControl Grid.Row="1" Content="{Binding Content}" Visibility="Visible">
            <ContentControl.Style>
                <Style TargetType="ContentControl">
                    <Style.Triggers>
                        <Trigger Property="Content" Value="{x:Null}">
                            <Setter Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ContentControl.Style>
        </ContentControl>
        <Grid x:Name="RootWelcomeGrid" Grid.Row="1" Visibility="{Binding SplashVisibility}">
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <ui:ProgressRing Visibility="{Binding SplashProgressVisibility}">
                    <ui:ProgressRing.Style>
                        <Style TargetType="ui:ProgressRing" BasedOn="{StaticResource {x:Type ui:ProgressRing}}">
                            <Setter Property="IsIndeterminate" Value="False"/>
                            <Style.Triggers>
                                <Trigger Property="Visibility" Value="Visible">
                                    <Setter Property="IsIndeterminate" Value="True"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ui:ProgressRing.Style>
                </ui:ProgressRing>
                <TextBlock x:Name="SplashProgressLabel" Margin="0 20" FontSize="16" FontWeight="Medium"
                    Text="{Binding SplashText}" TextAlignment="Center" TextWrapping="Wrap" />
                <TextBox x:Name="LinkTextBox" HorizontalAlignment="Center" Text="https://faforever.zulipchat.com/#narrow/stream/203511-python-server"
                         IsReadOnly="True" IsReadOnlyCaretVisible="False" Visibility="Collapsed" TextWrapping="Wrap" GotFocus="LinkTextBox_GotFocus"
                         ToolTip="Click to copy"/>

                <!--<StackPanel VerticalAlignment="Center">
                    <TextBlock Text="or use link below"/>
                </StackPanel>-->
            </StackPanel>
        </Grid>
        <ui:Snackbar
                        x:Name="RootSnackbar"
                        Title="Hello World!"
                        Grid.Row="1"
                        MaxWidth="600"
                        Appearance="Secondary"
                        Icon="PuzzlePiece24"
                        Message="Remember that the Heat Death of Universe is coming someday, no time to explain - let's go!"
                        Timeout="5000" />

        <!--  Dialogue is above all controls except the navigation buttons. So it covers all the content, but allows you to close or move the application.  -->
        <ui:Dialog
            x:Name="RootDialog"
            Grid.Row="0"
            Grid.RowSpan="2"
            ButtonLeftName="Click me if you can!"
            ButtonRightClick="RootDialog_OnButtonRightClick">
            <Grid>
                <StackPanel>
                    <TextBlock FontWeight="Medium" Text="WPF UI" />
                    <TextBlock
                        Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                        Text="What is it like to be a scribe? Is it good? In my opinion it's not about being good or not good. If I were to say what I esteem the most in life, I would say - people. People, who gave me a helping hand when I was a mess, when I was alone. And what's interesting, the chance meetings are the ones that influence our lives. The point is that when you profess certain values, even those seemingly universal, you may not find any understanding which, let me say, which helps us to develop. I had luck, let me say, because I found it. And I'd like to thank life. I'd like to thank it - life is singing, life is dancing, life is love. Many people ask me the same question, but how do you do that? where does all your happiness come from? And i replay that it's easy, it's cherishing live, that's what makes me build machines today, and tomorrow... who knows, why not, i would dedicate myself to do some community working and i would be, wham, not least... planting .... i mean... carrots."
                        TextAlignment="Justify"
                        TextWrapping="WrapWithOverflow" />
                </StackPanel>
            </Grid>
        </ui:Dialog>

        <!--
            For debugging the focus and the keyboard navigation,
            please make this view visible.
        -->
        <!--<diagnostics:DebuggingLayerView
            x:Name="DebuggingLayer"
            Grid.Row="0"
            Grid.RowSpan="2"
            d:Visibility="Visible"
            IsFocusIndicatorEnabled="False"
            IsHitTestVisible="False"
            Visibility="Visible" />-->

        <!--  The title bar contains window navigation elements and some Tray related extras.  -->
        <!--  You can put additional controls in the header, such as a search bar.  -->
        <!--  <ui:TitleBar.Header />  -->

        <!--
            ButtonsForeground="Aqua"
            Foreground="Red"
        -->
        <ui:TitleBar
            Grid.Row="0" Height="30" Padding="10 0"
            ForceShutdown="False"
            MinimizeToTray="False"
            ShowHelp="False"
            ShowMaximize="True"
            ShowMinimize="True"
            UseSnapLayout="True"
                     Icon="/Resources/logo.ico"
                     Title="Ethereal FAF Client">
            <ui:TitleBar.Header>
                <StackPanel
                    Margin="0,0,12,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">
                    <ToggleButton x:Name="LobbyPopup" Padding="2" Margin="4 0 0 0" FontSize="12">
                        <StackPanel Orientation="Horizontal" Margin="4 0 0 0">
                            <Ellipse Width="6" Height="6" Fill="LimeGreen"/>
                            <TextBlock Text="Lobby" Margin="4 0"/>
                        </StackPanel>
                    </ToggleButton>
                    <Popup IsOpen="{Binding IsChecked, ElementName=LobbyPopup}" StaysOpen="False" AllowsTransparency="True"
                       PlacementTarget="{Binding ElementName=LobbyPopup}"
                       Placement="Bottom">
                        <Border Style="{StaticResource BorderPopup}">
                            <StackPanel>
                                <TextBlock Text="Lobby connecition" FontSize="12"/>
                            </StackPanel>
                        </Border>
                    </Popup>
                    <ToggleButton x:Name="ChatPopup" Padding="2" Margin="4 0 0 0" FontSize="12">
                        <StackPanel Orientation="Horizontal" Margin="4 0 0 0">
                            <Ellipse Width="6" Height="6" Fill="Red"/>
                            <TextBlock Text="Chat" Margin="4 0"/>
                        </StackPanel>
                    </ToggleButton>
                    <Popup IsOpen="{Binding IsChecked, ElementName=ChatPopup}" StaysOpen="False" AllowsTransparency="True"
                       PlacementTarget="{Binding ElementName=ChatPopup}"
                       Placement="Bottom">
                        <Border Style="{StaticResource BorderPopup}">
                            <StackPanel>
                                <TextBlock Text="Chat connecition" FontSize="12"/>
                            </StackPanel>
                        </Border>
                    </Popup>
                    <ToggleButton Name="PopupToggeButton" Margin="4 0 0 0" Padding="2" ToolTip="Notifications">
                        <ui:SymbolIcon Symbol="Info24"/>
                    </ToggleButton>
                    <Popup IsOpen="{Binding IsChecked, ElementName=PopupToggeButton}" StaysOpen="False" AllowsTransparency="True"
                       PlacementTarget="{Binding ElementName=PopupToggeButton}"
                       Placement="Bottom">
                        <Border Style="{StaticResource BorderPopup}">
                            <StackPanel>
                                <!--<TextBlock Text="Notifications" FontSize="14"/>-->
                                <Button Content="Clean all notifications" FontSize="12" Margin="0 0 0 8"/>
                                <ItemsControl HorizontalContentAlignment="Stretch">
                                    <ui:Badge Appearance="Caution" Content="Caution"/>
                                    <ui:Badge Appearance="Danger" Content="Danger"/>
                                    <ui:Badge Appearance="Info" Content="Info"/>
                                    <ui:Badge Appearance="Success" Content="Success"/>
                                    <ui:Badge Appearance="Secondary" Content="Secondary"/>
                                    <ui:Badge Appearance="Light" Content="Light"/>
                                    <ui:Badge Appearance="Transparent" Content="Transparent"/>
                                    <ui:Badge Appearance="Dark" Content="Dark"/>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </Popup>
                </StackPanel>
            </ui:TitleBar.Header>
            <!--<ui:TitleBar.Tray>
                <ui:NotifyIcon
                    FocusOnLeftClick="True"
                    MenuOnRightClick="True"
                    TooltipText="WPF UI">
                    <ui:NotifyIcon.Menu>
                        <ContextMenu>
                            <ui:MenuItem
                                Click="TrayMenuItem_OnClick"
                                Header="Home"
                                SymbolIcon="Library28"
                                Tag="home" />
                            <ui:MenuItem
                                Click="TrayMenuItem_OnClick"
                                Header="Save"
                                SymbolIcon="Save24"
                                Tag="save" />
                            <ui:MenuItem
                                Click="TrayMenuItem_OnClick"
                                Header="Open"
                                SymbolIcon="Folder28"
                                Tag="open" />
                            <Separator />
                            <ui:MenuItem
                                Click="TrayMenuItem_OnClick"
                                Header="Reload"
                                SymbolIcon="ArrowClockwise24"
                                Tag="reload" />
                        </ContextMenu>
                    </ui:NotifyIcon.Menu>
                </ui:NotifyIcon>
            </ui:TitleBar.Tray>-->
        </ui:TitleBar>
    </Grid>
</ui:UiWindow>
